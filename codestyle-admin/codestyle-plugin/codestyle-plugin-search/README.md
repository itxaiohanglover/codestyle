# CodeStyle æ£€ç´¢æ¨¡å—

> åŸºäº CodeStyle é¡¹ç›®è§„èŒƒçš„ä¼ä¸šçº§å¤šæºæ··åˆæ£€ç´¢æ¨¡å—

[![Version](https://img.shields.io/badge/version-2.0-blue.svg)](DESIGN.md)
[![License](https://img.shields.io/badge/license-Apache%202.0-green.svg)](LICENSE)

---

## ğŸ“– æ¦‚è¿°

CodeStyle æ£€ç´¢æ¨¡å—æ˜¯ä¼ä¸šçº§çš„å¤šæºæ··åˆæ£€ç´¢è§£å†³æ–¹æ¡ˆï¼Œæ”¯æŒ Elasticsearch å…¨æ–‡æ£€ç´¢ã€Milvus å‘é‡æ£€ç´¢ï¼Œå¹¶æä¾›æ™ºèƒ½é‡æ’ã€å¤šçº§ç¼“å­˜å’Œå®Œå–„çš„å®¹é”™æœºåˆ¶ã€‚åŒæ—¶æä¾› MCP åè®®å¯¹æ¥ï¼Œæ”¯æŒä¸ AI IDE æ— ç¼é›†æˆã€‚

### âœ¨ æ ¸å¿ƒç‰¹æ€§

- ğŸ” **å¤šæºæ£€ç´¢**ï¼šæ”¯æŒ Elasticsearchã€Milvus ç­‰å¤šç§æ•°æ®æº
- ğŸ”„ **æ··åˆæ£€ç´¢**ï¼šä½¿ç”¨ RRF ç®—æ³•èåˆå…¨æ–‡æ£€ç´¢å’Œå‘é‡æ£€ç´¢ç»“æœ
- ğŸ“Š **æ™ºèƒ½é‡æ’**ï¼šé›†æˆ BGE-Rerank æ¨¡å‹æå‡ç›¸å…³æ€§
- ğŸš€ **é«˜æ€§èƒ½**ï¼šå¤šçº§ç¼“å­˜ï¼ˆCaffeine + Redisï¼‰
- ğŸ›¡ï¸ **é«˜å¯ç”¨**ï¼šå®Œå–„çš„å®¹é”™æœºåˆ¶ï¼ˆè¶…æ—¶æ§åˆ¶ã€é™çº§ç­–ç•¥ã€é‡è¯•æœºåˆ¶ï¼‰
- ğŸ”Œ **MCP å¯¹æ¥**ï¼šæä¾›æ ‡å‡† MCP APIï¼Œæ”¯æŒ AI IDE è°ƒç”¨
- ğŸ“ **è§„èŒƒç»Ÿä¸€**ï¼šéµå¾ª CodeStyle é¡¹ç›®å¼€å‘è§„èŒƒ

---

## ğŸ“‚ æ–‡æ¡£å¯¼èˆª

| æ–‡æ¡£ | è¯´æ˜ |
|------|------|
| [DESIGN.md](DESIGN.md) | ğŸ—ï¸ æ¶æ„è®¾è®¡æ–‡æ¡£ |
| [IMPLEMENTATION.md](IMPLEMENTATION.md) | ğŸ“ å®ç°è§„åˆ’æ–‡æ¡£ |
| [archive/](archive/) | ğŸ“¦ å†å²æ–‡æ¡£å½’æ¡£ |

---

## ğŸ—ï¸ æ¶æ„è®¾è®¡

### æ•´ä½“æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Controller å±‚                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚ SearchController â”‚      â”‚  McpController   â”‚        â”‚
â”‚  â”‚  (REST API)      â”‚      â”‚  (MCP åè®®)      â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Service å±‚                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  SearchService (æ£€ç´¢ç¼–æ’æœåŠ¡)                      â”‚  â”‚
â”‚  â”‚  - å•æºæ£€ç´¢                                        â”‚  â”‚
â”‚  â”‚  - æ··åˆæ£€ç´¢ (RRF èåˆ)                            â”‚  â”‚
â”‚  â”‚  - æ£€ç´¢å¹¶é‡æ’                                      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                            â†“                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ES æ£€ç´¢æœåŠ¡   â”‚ Milvus æ£€ç´¢   â”‚ é‡æ’æœåŠ¡          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Helper å±‚                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ç¼“å­˜åŠ©æ‰‹      â”‚ èåˆç®—æ³•åŠ©æ‰‹  â”‚ å®¹é”™åŠ©æ‰‹          â”‚   â”‚
â”‚  â”‚ CacheHelper  â”‚ FusionHelper â”‚ FallbackHelper   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ æ ¸å¿ƒåŠŸèƒ½

### 1. æ£€ç´¢ API

#### å•æºæ£€ç´¢

```bash
POST /api/search/single
{
  "query": "å¦‚ä½•é…ç½® MySQL è¿æ¥æ± ",
  "sourceType": "ELASTICSEARCH",
  "topK": 10
}
```

#### æ··åˆæ£€ç´¢

```bash
POST /api/search/hybrid
{
  "query": "å¦‚ä½•é…ç½® MySQL è¿æ¥æ± ",
  "topK": 10
}
```

#### æ£€ç´¢å¹¶é‡æ’

```bash
POST /api/search/rerank
{
  "query": "å¦‚ä½•é…ç½® MySQL è¿æ¥æ± ",
  "topK": 10,
  "enableRerank": true
}
```

### 2. MCP APIï¼ˆä¸ AI IDE å¯¹æ¥ï¼‰

#### æœç´¢æ¨¡æ¿å…ƒæ•°æ®

```bash
GET /api/mcp/search?query=CRUD
Authorization: Bearer {apiKey}

è¿”å›: List<RemoteMetaConfig>
```

**å“åº”æ ¼å¼**ï¼š
```json
[
  {
    "groupId": "continew",
    "artifactId": "CRUD",
    "description": "å¢åˆ æ”¹æŸ¥ä»£ç ç”Ÿæˆæ¨¡æ¿",
    "config": {
      "version": "1.0.0",
      "files": [...]
    }
  }
]
```

#### ä¸‹è½½æ¨¡æ¿æ–‡ä»¶

```bash
GET /api/file/load?paths=/continew/CRUD
è¿”å›: ZIP æ–‡ä»¶
```

### 3. å¤šçº§ç¼“å­˜

```
L1: Caffeine æœ¬åœ°ç¼“å­˜ (5åˆ†é’Ÿ)
    â†“ Miss
L2: Redis åˆ†å¸ƒå¼ç¼“å­˜ (1å°æ—¶)
    â†“ Miss
æ•°æ®æºæŸ¥è¯¢ (ES/Milvus)
```

### 4. å®¹é”™æœºåˆ¶

- â±ï¸ **è¶…æ—¶æ§åˆ¶**ï¼šå¯é…ç½®çš„æŸ¥è¯¢è¶…æ—¶æ—¶é—´
- ğŸ”„ **é‡è¯•æœºåˆ¶**ï¼šè‡ªåŠ¨é‡è¯•å¤±è´¥çš„è¯·æ±‚
- ğŸ“‰ **é™çº§ç­–ç•¥**ï¼šæœåŠ¡å¼‚å¸¸æ—¶è¿”å›é™çº§ç»“æœ
- ğŸ”Œ **ç†”æ–­ä¿æŠ¤**ï¼šé˜²æ­¢é›ªå´©æ•ˆåº”

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. é…ç½®

åœ¨ `application.yml` ä¸­æ·»åŠ ï¼š

```yaml
search:
  enabled: true

  elasticsearch:
    enabled: true
    hosts: localhost:9200
    index: codestyle_templates

  milvus:
    enabled: false
    host: localhost
    port: 19530

  rerank:
    enabled: false
    api-url: http://localhost:8001/rerank

  cache:
    enabled: true
    local:
      max-size: 1000
      ttl: 300
    redis:
      ttl: 3600
```

### 2. Maven ä¾èµ–

```xml
<dependency>
    <groupId>top.codestyle.admin</groupId>
    <artifactId>codestyle-plugin-search</artifactId>
    <version>${revision}</version>
</dependency>
```

### 3. ä»£ç ä½¿ç”¨

```java
@Autowired
private SearchService searchService;

// æ‰§è¡Œæ£€ç´¢
SearchRequest request = new SearchRequest();
request.setQuery("MySQL è¿æ¥æ± é…ç½®");
request.setTopK(10);

List<SearchResult> results = searchService.hybridSearch(request);
```

---

## ğŸ“Š é¡¹ç›®çŠ¶æ€

### å½“å‰å®ç°çŠ¶æ€

```
æ€»è¿›åº¦ï¼šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 50%

âœ… æ¶æ„è®¾è®¡     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 100%
âœ… æ–‡æ¡£æ•´ç†     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 100%
â³ ä»£ç å®ç°     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  50%
  - ES æ£€ç´¢     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 100%
  - æ··åˆæ£€ç´¢     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘  80%
  - Milvus æ£€ç´¢ â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  20%
  - MCP API     â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘   0%
â³ æµ‹è¯•éªŒè¯     â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘   0%
```

### å¾…å®ŒæˆåŠŸèƒ½

- [ ] å®Œå–„ Milvus æ£€ç´¢ç»“æœè½¬æ¢
- [ ] å®ç° MCP APIï¼ˆ/api/mcp/search, /api/file/loadï¼‰
- [ ] æ¸…ç† SPI/Provider é—ç•™ä»£ç 
- [ ] è¡¥å……å•å…ƒæµ‹è¯•
- [ ] æ€§èƒ½æµ‹è¯•å’Œä¼˜åŒ–

---

## ğŸ’¡ è®¾è®¡äº®ç‚¹

### 1. éµå¾ªé¡¹ç›®è§„èŒƒ

- âœ… ä½¿ç”¨ Service/Helper å‘½å
- âœ… éµå¾ª CodeStyle åˆ†å±‚æ¶æ„
- âœ… ç»Ÿä¸€å¼‚å¸¸å¤„ç†å’Œæ—¥å¿—è§„èŒƒ

### 2. MCP åè®®å¯¹æ¥

- âœ… æ”¯æŒä¸ mcp-codestyle-server å¯¹æ¥
- âœ… æ ‡å‡†åŒ–çš„ RemoteMetaConfig æ•°æ®æ ¼å¼
- âœ… æ”¯æŒæ¨¡æ¿æœç´¢å’Œæ–‡ä»¶ä¸‹è½½

### 3. ç”Ÿäº§å¯ç”¨

- âœ… å®Œå–„çš„å®¹é”™æœºåˆ¶
- âœ… å¤šçº§ç¼“å­˜ç­–ç•¥
- âœ… æ€§èƒ½ç›‘æ§æŒ‡æ ‡

---

## ğŸ¤ è´¡çŒ®æŒ‡å—

### å¼€å‘è§„èŒƒ

1. **å‘½åè§„èŒƒ**ï¼šéµå¾ª CodeStyle é¡¹ç›®è§„èŒƒ
2. **ä»£ç æ ¼å¼**ï¼šä½¿ç”¨ Spotless è‡ªåŠ¨æ ¼å¼åŒ–
3. **æ³¨é‡Šè§„èŒƒ**ï¼šæ‰€æœ‰ç±»å’Œæ–¹æ³•å¿…é¡»æœ‰ Javadoc
4. **æµ‹è¯•è¦æ±‚**ï¼šå•å…ƒæµ‹è¯•è¦†ç›–ç‡ > 80%

### æäº¤æµç¨‹

1. Fork é¡¹ç›®
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯
3. æäº¤ä»£ç ï¼ˆéµå¾ªè§„èŒƒï¼‰
4. åˆ›å»º Pull Request

---

## ğŸ“š å‚è€ƒèµ„æ–™

### é¡¹ç›®æ–‡æ¡£

- [CodeStyle æœ€ä½³å®è·µ](../../../CODESTYLE_BEST_PRACTICES.md)
- [CodeStyle è¿›é˜¶å®è·µ](../../../CODESTYLE_BEST_PRACTICES_ADVANCED.md)

### å¤–éƒ¨èµ„æº

- [MCP åè®®è§„èŒƒ](https://modelcontextprotocol.io/)
- [Elasticsearch å®˜æ–¹æ–‡æ¡£](https://www.elastic.co/guide/en/elasticsearch/reference/current/index.html)
- [Milvus å®˜æ–¹æ–‡æ¡£](https://milvus.io/docs)
- [BGE-Rerank æ¨¡å‹](https://huggingface.co/BAAI/bge-reranker-v2-m3)

---

## ğŸ“„ è®¸å¯è¯

Apache License 2.0

---

## ğŸ‘¥ å›¢é˜Ÿ

**å¼€å‘å›¢é˜Ÿ**: CodeStyle Team
**æœ€åæ›´æ–°**: 2026-02-16

---

**â­ å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·ç»™æˆ‘ä»¬ä¸€ä¸ª Starï¼**
